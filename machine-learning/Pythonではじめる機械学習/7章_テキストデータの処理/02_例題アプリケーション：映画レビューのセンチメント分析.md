
02 ä¾‹é¡Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼šæ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆåˆ†æ
==============================================

* æœ¬ç« ã§ã¯ã€Webã‚µã‚¤ãƒˆã®æ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç”¨ã„ã‚‹

    * ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã¯ã€æ˜ ç”»ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ã€ãã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè‚¯å®šçš„`pos`ã‹å¦å®šçš„`neg`ã‹ã‚’ç¤ºã™ãƒ©ãƒ™ãƒ«ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹
    
    * 1ã‹ã‚‰10ç‚¹ã®æ¡ç‚¹ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹
    
    * ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚ã«ã€ã“ã®ç‚¹ãŒ6ç‚¹ä»¥ä¸Šã®å ´åˆã«ã€Œè‚¯å®šçš„ã€ã€ãã‚Œä»¥å¤–ã®å ´åˆã‚’ã€Œå¦å®šçš„ã€ã¨ã—ã¦ã€2ã‚¯ãƒ©ã‚¹åˆ†é¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦ã„ã‚‹

* ãƒ‡ãƒ¼ã‚¿ã‚’è§£å‡ã™ã‚‹ã¨ã€ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒ2ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã«æ ¼ç´ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹

    * ãã‚Œãã‚Œã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã€ã•ã‚‰ã«`pos`ã¨`neg`ã¨ã„ã†ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚‹


```python
!tree -dL 2 ~/data/aclImdb
```

    [01;34m/Users/MacUser/data/aclImdb[00m
    â”œâ”€â”€ [01;34mtest[00m
    â”‚Â Â  â”œâ”€â”€ [01;34mneg[00m
    â”‚Â Â  â””â”€â”€ [01;34mpos[00m
    â””â”€â”€ [01;34mtrain[00m
        â”œâ”€â”€ [01;34mneg[00m
        â”œâ”€â”€ [01;34mpos[00m
        â””â”€â”€ [01;34munsup[00m
    
    7 directories


* `pos`ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯è‚¯å®šçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã€ãã‚Œãã‚Œç‹¬ç«‹ã—ãŸãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ ¼ç´ã•ã‚Œã¦ã„ã‚‹

* `neg`ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯å¦å®šçš„ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã€åŒæ§˜ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹

* `unsup`ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯ãƒ©ãƒ™ãƒ«ã®ä»˜ã„ã¦ã„ãªã„ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹ãŒã€ã“ã‚Œã¯ä½¿ç”¨ã—ãªã„ãŸã‚å‰Šé™¤ã™ã‚‹


```python
!rm -r ~/data/aclImdb/train/unsup
```

* scikit-learnã«ã¯ã“ã®ã‚ˆã†ãªãƒ©ãƒ™ãƒ«ãŒã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã«å¯¾å¿œã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã®é–¢æ•°`load_files`ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹

    * ã¾ãšã€`load_files`é–¢æ•°ã‚’ç”¨ã„ã¦è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€


```python
from sklearn.datasets import load_files

reviews_train = load_files("/Users/MacUser/data/aclImdb/train/")
# load_filesã¯ä¸€é€£ã®è¨“ç·´ãƒ†ã‚­ã‚¹ãƒˆã¨è¨“ç·´ãƒ©ãƒ™ãƒ«ã‚’è¿”ã™
text_train, y_train = reviews_train.data, reviews_train.target
print("type of text_train: {}".format(type(text_train)))
print("length of text_train: {}".format(len(text_train)))
print("text_train[6]:\n{}".format(text_train[6]))
```

    type of text_train: <class 'list'>
    length of text_train: 25000
    text_train[6]:
    b"This movie has a special way of telling the story, at first i found it rather odd as it jumped through time and I had no idea whats happening.<br /><br />Anyway the story line was although simple, but still very real and touching. You met someone the first time, you fell in love completely, but broke up at last and promoted a deadly agony. Who hasn't go through this? but we will never forget this kind of pain in our life. <br /><br />I would say i am rather touched as two actor has shown great performance in showing the love between the characters. I just wish that the story could be a happy ending."


* `text_train`ã¯ãªãŒã•25,000ã®ãƒªã‚¹ãƒˆã§ã€å€‹ã€…ã®è¦ç´ ã«ã¯ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒæ–‡å­—åˆ—ã¨ã—ã¦å«ã¾ã‚Œã¦ã„ã‚‹

    * ã“ã“ã§ã¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹1ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹
    
    * ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã¯HTMLã®æ”¹è¡Œã‚·ãƒ¼ã‚±ãƒ³ã‚¹(<br />)ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹
    
    * å–ã‚Šé™¤ã„ã¦ãŠã


```python
text_train = [doc.replace(b"<br />", b" ") for doc in text_train]
```

* `text_train`ã®å€‹ã€…ã®è¦ç´ ã®å‹ã¯Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ä¾å­˜ã™ã‚‹(Python3ï¼šæ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã®ãƒã‚¤ãƒŠãƒªè¡¨ç¾ã€byteså‹)

* ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯è‚¯å®šçš„ãªã‚¯ãƒ©ã‚¹ã¨å¦å®šçš„ãªã‚¯ãƒ©ã‚¹ãŒãƒãƒ©ãƒ³ã‚¹ã™ã‚‹ã‚ˆã†ã«é›†ã‚ã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€è‚¯å®šçš„ã€å¦å®šçš„ã®ä¸¡æ–¹ã«å¤šæ•°ã®æ–‡å­—åˆ—ãŒã‚ã‚‹


```python
import numpy as np
print("Samples per class (training): {}".format(np.bincount(y_train)))
```

    Samples per class (training): [12500 12500]


* åŒæ§˜ã«ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚‚ãƒ­ãƒ¼ãƒ‰ã™ã‚‹


```python
reviews_test = load_files("/Users/MacUser/data/aclImdb/test/")
text_test, y_test = reviews_test.data, reviews_test.target
print("Number of documents in test data: {}".format(len(text_test)))
print("Samples per class (test): {}".format(np.bincount(y_test)))
text_test = [doc.replace(b"<br />", b" ") for doc in text_test]
```

    Number of documents in test data: 25000
    Samples per class (test): [12500 12500]


* ã“ã“ã§è§£ã“ã†ã¨ã—ã¦ã„ã‚‹å•é¡Œã¯æ¬¡ã®é€šã‚Š

    * ã‚ã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«å¯¾ã—ã¦ã€ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ†ã‚­ã‚¹ãƒˆã«åŸºã¥ã„ã¦ã€Œè‚¯å®šçš„ã€ã‚‚ã—ãã¯ã€Œå¦å®šçš„ã€ã®ãƒ©ãƒ™ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã‚‹
    
    * ã“ã‚Œã¯ã€æ¨™æº–çš„ãª2ã‚¯ãƒ©ã‚¹åˆ†é¡ã‚¿ã‚¹ã‚¯ã§ã‚ã‚‹
    
    * ã—ã‹ã—ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯æ©Ÿæ¢°å­¦ç¿’ãŒæ‰±ãˆã‚‹ã‚ˆã†ãªå½¢å¼ã«ãªã£ã¦ã„ãªã„
    
    * ãƒ†ã‚­ã‚¹ãƒˆã®æ–‡å­—åˆ—è¡¨ç¾ã‚’æ©Ÿæ¢°å­¦ç¿’ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é©ç”¨ã§ãã‚‹ã‚ˆã†ãªæ•°å€¤è¡¨ç¾ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

| ç‰ˆ   | å¹´/æœˆ/æ—¥   |
| ---- | ---------- |
| åˆç‰ˆ | 2019/04/06 |
